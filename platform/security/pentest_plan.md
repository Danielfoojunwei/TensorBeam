# MOAI Platform Pentest Plan

**Scope**: MOAI Control Plane API & Backend
**Methodology**: OWASP Mobile/Web Application Security Verification Standard (ASVS)
**Mode**: Defensive / Gray Box

## 1. Attack Surface Analysis
*   **API Endpoints**: `/jobs`, `/tenants`, `/keys` (Upload handlers are high risk)
*   **Parsers**: `JobRequest` JSON, Ciphertext deserializers (Proto/Flatbuffers)
*   **Data Stores**: Postgres (SQLi), FileSystem (Path traversal)

## 2. Testing Modules

### A. Authentication & Authorization
*   [ ] Verify JWT signature enforcement.
*   [ ] Test Role-Based Access Control (RBAC): Can Tenant A access Tenant B's keys?
*   [ ] Check for IDOR (Insecure Direct Object References) on `/jobs/{id}`.

### B. Input Validation
*   [ ] **Ciphertext Bomb**: Upload 10GB request body. Verify 413 Payload Too Large.
*   [ ] **Path Traversal**: Attempt `tenant_id="../root"` in file paths.
*   [ ] **Fuzzing**: Send malformed Protobuf bytes to Inference Engine.

### C. Dependency Logic
*   [ ] `libmoai_gpu.so` boundary: Ensure segfaults in C++ don't crash the Python web server (Process isolation).
*   [ ] GPU Denial of Service: Submit batch size 1,000,000. Verify OOM handling.

## 3. Tools
*   **SAST**: Semgrep, Bandit (Python)
*   **DAST**: OWASP ZAP (API Scan)
*   **Fuzzing**: Atheris (Python)

## 4. Execution
Run `make security_scan` to execute the baseline checks.
